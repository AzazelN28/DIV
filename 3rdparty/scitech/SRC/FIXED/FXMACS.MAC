;****************************************************************************
;*
;*						  Techniques Class Library
;*
;*               Copyright (C) 1991-1997 SciTech Software, Inc.
;*                            All rights reserved.
;*
;*  ======================================================================
;*       This library is free software; you can use it and/or
;*       modify it under the terms of the SciTech MGL Software License.
;*
;*       This library is distributed in the hope that it will be useful,
;*       but WITHOUT ANY WARRANTY; without even the implied warranty of
;*       MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
;*       SciTech MGL Software License for more details.
;*  ======================================================================
;*
;* Filename:	$Workfile:   fxmacs.mac  $
;* Version:		$Revision:   1.1  $
;*
;* Language:	80386 Assembler
;* Environment:	IBM PC (MS DOS)
;*
;* Description:	Macros used by the fixed point assembler routines.
;*
;* $Date:   01 Oct 1997 05:38:10  $ $Author:   KendallB  $
;*
;****************************************************************************

; Define a macro to round the multiplied value in EAX:EDX and stick the
; resulting fixed point number in EAX.

MACRO	ROUNDIT
		add		eax,8000h		; Round by adding 2^-17
		adc		edx,0			; Whole part of result is in EDX
		shrd	eax,edx,16		; Shift the fractional part into EAX
ENDM

; Define a macro to round the result in EBX:ECX and stick the resulting
; fixed point number in EAX.

MACRO	ROUNDIT_EBX_ECX
		mov		eax,ecx
		add		eax,8000h		; Round by adding 2^-17
		adc		ebx,0			; Whole part of result is in EBX
		shrd	eax,ebx,16		; Shift the fractional part into EAX
ENDM
